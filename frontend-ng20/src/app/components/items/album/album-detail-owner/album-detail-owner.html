<app-navbar></app-navbar>

<div class="w-full px-4 py-6">
  <!-- Title -->
  <h2 class="text-3xl text-center font-audiowide text-custom-violet mb-8 break-words">
    {{ this.album.name }}
  </h2>

  <!-- Main content grid -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Left: Album Description and STLs -->
    <div class="flex flex-col gap-6">
      <!-- Description -->
      <div class="rounded-md border border-custom-blue-night bg-custom-bright-lilac p-4 shadow">
        <h3 class="text-lg font-audiowide text-center mb-2 text-custom-violet">Album Description</h3>
        <p class="text-center text-custom-violet">{{ this.album.description }}</p>
      </div>
      <!-- STL List -->
      <div class="rounded-md border border-custom-blue-night bg-custom-bright-lilac p-4 shadow">
        <h3 class="text-lg font-audiowide text-center mb-4 text-custom-violet">Included STLs</h3>
        <div class="flex flex-col gap-4">
            @for (stl of this.includedSTLs; track stl) {
                <div
                class="flex items-center justify-between bg-custom-violet text-custom-bright-lilac p-2 rounded shadow"
                >
                <span class="font-audiowide">{{ stl.name }}</span>
                <button (click)="removeSTLFromAlbum(stl.id??0)" class="text-red-500 hover:underline">Remove</button>
            </div>
            }
        </div>

        <!-- Add STL to Album -->
        <div class="mt-4">
            <div class="flex flex-col justify-center gap-2">
            <label class="block text-custom-violet font-audiowide mb-1">Add STL:</label>
            <ng-select
                [items]="this.stlsToAdd"
                [(ngModel)]="selectedSTLId"
                bindLabel="name"
                bindValue="id"
                [searchable]="true"
                class="w-auto  border rounded-md p-2 bg-white"
            ></ng-select>
            <button (click)="addSTLToAlbum()" class="button3">Add</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Right: Album Info and Actions -->
    <div class="flex flex-col gap-6">
      <!-- Stats -->
      <div class="bg-custom-violet text-custom-bright-lilac rounded-md p-4 shadow flex flex-col gap-2 items-center">
        <div class="font-audiowide text-lg">üí∂ Price: {{ this.album.price || 0 }} ‚Ç¨</div>
        <div class="font-audiowide text-lg">üëç Likes: {{ this.album.likes || 0 }}</div>
        <div class="font-audiowide text-lg">üì• Downloads: {{ this.album.downloads || 0 }}</div>
      </div>

      <!-- Buttons -->
      <div class="flex justify-center gap-4 flex-wrap">
        <button (click)="goToUpdateAlbum()" class="button3">Update Album</button>
        <button (click)="openDeletionDialog()" class="button2">Delete Album</button>
      </div>
    </div>
  </div>
</div>

<!-- Confirm Deletion Modal -->
@if (this.confirmDeletionDialog) {
  <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md">
      <h3 class="text-xl font-bold text-center mb-4 text-red-600">‚ö†Ô∏è Confirm Deletion</h3>
      <p class="text-center mb-6">Are you sure you want to delete this album? This action is irreversible.</p>
      <div class="flex justify-center gap-4">
        <button (click)="this.deleteAlbum()" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition">
          Yes, Delete
        </button>
        <button (click)="this.confirmDeletionDialog=false" class="px-4 py-2 bg-gray-300 text-gray-800 rounded hover:bg-gray-400 transition">
          Cancel
        </button>
      </div>
    </div>
  </div>
}
